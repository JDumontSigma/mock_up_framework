{% extends 'partials/layout.html' %}
{% block title %}Dashboard{% endblock %}
{% block nav %}

   <nav class="nav-primary">
      <img src="http://www.sanger.ac.uk/sites/all/themes/zangerfront/images/wtsi_logo.png" alt="">
      <h1>Sanger Aker thing</h1>
      <ul>
         <li><a href="./account.html">Account</a></li>
         <li><a href="./index.html">Logout</a></li>
      </ul>
   </nav>

{% endblock %}

{% block content %}
<div class="container">
   <h3 class="name" style="text-transform: capitalize;"></h3>
    <p style="font-size:1.8rem; margin-top:20px;">Please find the latest test below. You are able to create new test, edit previous tests from this page</p>
   <section class="studiesContainer">
      <div class="col-sm-12" style="padding:2.5em 4em; box-shadow: 0px 5px 5px 0px rgba(0,0,0,0.24); margin-top:60px;">
         <button class="btn btn-lg btn-primary" style="float:right" data-toggle="modal" data-target="#myModal">Add Study</button>
      <section class="studies_heading" style="display:flex; width:100%; margin-top:60px;">
        <h4 style="flex:3;">Project title</h4>
        <h4 style="flex:1;text-align:center;">Start Date</h4>
        <h4 style="flex:1;text-align:center;">Project Code</h4>
        <h4 style="flex:1;text-align:center;">State</h4>
      </section>
      <section class="studies" style="display:flex; width:100%; margin-top:20px;">

         
         
      </section>
      
      </div>
   </section>
</div>



<!-- Modal -->
  <div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Create a new study</h4>
        </div>
        <div class="modal-body">
          <p>To make a new study please choose whether to import the data or create a new study all together</p>
          <a href="./prelim.html?phase=import"class="btn btn-lg btn-default">Import Data from File</a>
          <a href="./prelim.html?phase=new" class="btn btn-lg btn-primary">Manual Enter</a>
        </div>
      </div>
      
    </div>
  </div>
   
{% endblock %}

{% block footer %}
<footer>
   <p>&copy; Copyright &verbar; All Rights Reserved</p>
</footer>
{% endblock %}

{% block customScripts %}
<script type="text/javascript">
var name = Cookies.get('username');
$('.name').html('Welcome Back ' + name);
</script>

<script type="text/javascript">
var tests = Cookies.getJSON('test');
var testDetails = '';
for(var test in tests) {
  if(test !== 'studyCount') {
   testDetails += '<a href="./study.html?id=' + test + '&name=' + tests[test].name + '&code=' + tests[test].code + '&date=' + tests[test].date + '&status=' + tests[test].status + '">';
            testDetails += '<section class="studyItem">';
               testDetails += '<h4>' + tests[test].name + '</h4>'
               testDetails += '<section class="studyInfo">';
                  testDetails += '<div class="date">' + tests[test].date + '</div>';
                  testDetails += '<div class="code">' + tests[test].code + '</div>';
                  switch(String(tests[test].status).toLowerCase()) {
                    case 'active' :
                      testDetails += '<div class="state btn btn-success btn-xs">' + tests[test].status + '</div>';
                    break;
                    case 'inactive' :
                      testDetails += '<div class="state btn btn-default btn-xs">' + tests[test].status + '</div>';
                    break;
                    case 'waiting' :
                      testDetails += '<div class="state btn btn-warning btn-xs">' + tests[test].status + '</div>';
                    break; 
                  }
                  
               testDetails += '</section>';
            testDetails += '</section>';
         testDetails += '</a>';
}
}
$('.studies').append(testDetails);

</script>
{% endblock %}